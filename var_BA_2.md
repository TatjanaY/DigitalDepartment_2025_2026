# 📈 Кейс. Бизнес-аналитика маркетплейса: продажи, клиенты, удержание и эффективность маркетинга

## 🎯 Постановка задачи

Компания управляет **онлайн-маркетплейсом товаров массового спроса** и стремится оптимизировать продуктовую стратегию, маркетинговые инвестиции и работу с клиентами на основе данных.

**Цель исследования** — определить:  
- какие **пользовательские сегменты** приносят наибольшую выручку;  
- как **поведение клиентов** меняется со временем;  
- какие **категории товаров** формируют основной оборот;  
- насколько **окупаются маркетинговые каналы**.

> ⚠️ **Важно**: датасеты **не связаны напрямую** на уровне пользователей.  
> Их совместное использование основано на **аналитических допущениях и модельной интерпретации**, что соответствует практике стратегического бизнес-анализа.

В рамках кейса необходимо провести **комплексный бизнес-анализ** на основе **трёх независимых датасетов**, включающий расчёт ключевых метрик: **Retention, Conversion, LTV и ROI**.

**Результатом выполнения задания** должен стать **Jupyter Notebook**, содержащий код, расчёты, функции, визуализации и аналитические выводы.

---

## 📦 Используемые датасеты

В рамках кейса используются **три независимых датасета**, отражающих разные аналитические слои.

### 📁 Входные данные (обзор)

---

### 📄 Датасет 1 — Brazilian E-Commerce Public Dataset by Olist  
**Kaggle:** [https://www.kaggle.com/datasets/olistbr/brazilian-ecommerce](https://www.kaggle.com/datasets/olistbr/brazilian-ecommerce)  

**Тип данных:** транзакционные данные маркетплейса  

**Основные признаки:**  
- `order_id` — идентификатор заказа  
- `customer_id` — покупатель  
- `order_purchase_timestamp` — дата покупки  
- `order_status` — статус заказа  
- `price` — стоимость товара  
- `freight_value` — стоимость доставки  

**Назначение:**  
Используется как **основной источник продуктовых данных** для расчёта **выручки, retention, LTV, пользовательских профилей** и анализа **товарных категорий**.

---

### 📄 Датасет 2 — Customer Segmentation Dataset  
**Kaggle:** [https://www.kaggle.com/datasets/vetrirah/customer](https://www.kaggle.com/datasets/vetrirah/customer)  

**Тип данных:** синтетический учебный датасет с демографией  

**Основные признаки:**  
- `CustomerID` — уникальный пользователь  
- `Gender` — пол  
- `Age` — возраст  
- `Annual Income` — доход  
- `Spending Score` — поведенческий показатель  

**Назначение:**  
Используется **как отдельный блок** для демонстрации **сегментации и кластеризации клиентов**.  
⚠️ **Не объединяется напрямую** с транзакциями. Результаты интерпретируются **концептуально**.

---

### 📄 Датасет 3 — Marketing Campaign Dataset  
**Kaggle:** [https://www.kaggle.com/datasets/rodsaldanha/arketing-campaign](https://www.kaggle.com/datasets/rodsaldanha/arketing-campaign)  

**Тип данных:** агрегированные данные маркетинговых кампаний  

**Основные признаки:**  
- `Campaign` — идентификатор кампании  
- `Channel` — канал привлечения  
- `Cost` — маркетинговые затраты  
- `Leads` — количество лидов  
- `Conversions` — количество совершённых покупок  

**Назначение:**  
Используется для расчёта **CAC, ROI и эффективности каналов**.  
⚠️ **Не содержит связи с конкретными заказами**. Связь с LTV устанавливается **на уровне допущений**.

---

## 📝 Обязательные разделы итогового Jupyter Notebook

1. Предварительный анализ данных  
2. Предобработка данных  
3. Разработка функций для анализа данных  
4. Разработка функции для создания пользовательских профилей  
5. Разработка функций расчёта продуктовых и бизнес-метрик  
6. Визуализация продуктовых и бизнес-метрик  
7. Исследовательский анализ данных  
8. Маркетинг и анализ окупаемости  
9. Выводы  

---

## 🧩 Структура итогового Jupyter Notebook

### 1. 📊 Предварительный анализ данных  
**Цель раздела:** понять структуру, качество и ограничения данных.  

**Необходимо:**  
- вывести размеры таблиц (`shape`);  
- изучить типы данных (`info`);  
- оценить пропуски и аномалии (например, `price ≤ 0`, `Cost < 0`);  
- кратко описать особенности каждого датасета.  

**В конце раздела:** краткие выводы по данным и их пригодности к анализу.

---

### 2. 🧹 Предобработка данных  
**Цель раздела:** подготовить данные к расчёту метрик и анализу.  

**Необходимо:**  
- **Для Olist**:  
  - привести `order_purchase_timestamp` к `datetime`;  
  - отфильтровать заказы со статусом ≠ `delivered`;  
  - рассчитать выручку как `price + freight_value`;  
  - агрегировать по `customer_id` и временным периодам.  
- **Для Customer Segmentation**:  
  - обработать пропуски;  
  - при необходимости нормализовать признаки.  
- **Для Marketing Campaign**:  
  - проверить корректность `Cost`, `Leads`, `Conversions`.  

**В конце раздела:** промежуточные выводы о готовности данных.

---

### 3. 🧠 Разработка функций для анализа данных  
**Цель раздела:** создать переиспользуемый аналитический инструментарий.  

**Ключевое правило:**  
> Все функции — расчёта метрик и визуализации — создаются здесь,  
> но **графики строятся и анализируются в отдельном разделе**.

**В этом разделе разрабатываются функции:**

1. **Для агрегации данных:**  
   - по пользователям;  
   - по временным периодам (день / неделя / месяц);  
   - по категориям товаров (из Olist).  

2. **Для фильтрации данных:**  
   - по датам;  
   - по статусам заказов;  
   - по маркетинговым каналам.  

3. **Для расчёта базовых метрик:**  
   - DAU / MAU;  
   - количество заказов;  
   - суммарная и средняя выручка.  

4. **Для формирования пользовательских профилей:**  
   - дата первой/последней покупки;  
   - количество заказов;  
   - суммарная выручка;  
   - lifetime (в днях);  
   - (опционально) RFM-сегментация.  

5. **Для расчёта продуктовых и бизнес-метрик:**  
   - Retention;  
   - Conversion;  
   - LTV;  
   - CAC;  
   - ROI.  

6. **Для визуализации:**  
   - line chart;  
   - bar chart;  
   - heatmap;  
   - funnel chart;  
   - scatter plot.  

**Структура раздела:**  
- краткое введение в модульность и повторное использование кода;  
- реализация функций с аннотациями;  
- перечень функций и их назначение.

---

### 4. 👤 Создание пользовательских профилей  
**Цель раздела:** сегментировать клиентов маркетплейса.  

**Необходимо:**  
- использовать разработанные функции;  
- рассчитать для каждого клиента:  
  - дату первой покупки;  
  - дату последней покупки;  
  - количество заказов;  
  - суммарную выручку;  
  - lifetime;  
- при желании реализовать **RFM-сегментацию**.  

**В конце раздела:** выводы по выявленным сегментам (например, «активные покупатели с высоким чеком»).

---

### 5. 📐 Расчёт продуктовых и бизнес-метрик  

#### 5.1 🔁 Расчёт удержания (Retention)  
- формирование когорт по дате первой покупки;  
- расчёт retention rate по неделям/месяцам;  
- создание retention-матрицы (когорта × период жизни).  

#### 5.2 🔄 Расчёт конверсии  
- конверсия:  
  - лид → покупка (на основе Датасета 3);  
  - по маркетинговым каналам (`Channel`);  
  - доля повторных покупателей (на основе Olist).  

#### 5.3 💰 Расчёт LTV и ROI  
- расчёт LTV по пользователям и когортам (Olist);  
- расчёт CAC = `Cost / Leads` (Marketing Campaign);  
- расчёт ROI = (LTV – CAC) / CAC **на основе модельных допущений**.  

> **Важно:** в этом разделе используются функции, но **визуализация переносится в раздел 6**.

---

### 6. 📉 Визуализация продуктовых и бизнес-метрик  
**Цель раздела:** визуально представить и интерпретировать результаты.  

**Визуализации:**  

1. **🔁 Retention**  
   - Heatmap: X — период жизни, Y — когорта, цвет — retention %;  
   - Line chart: X — время, Y — retention %, линии — когорты.  

2. **🔄 Conversion**  
   - Funnel chart: лид → покупка;  
   - Bar chart: X — каналы, Y — conversion rate.  

3. **💰 LTV и ROI**  
   - Line chart: X — lifetime, Y — накопленный LTV по когортам;  
   - Bar chart: X — каналы, Y — ROI;  
   - Scatter plot: X — CAC, Y — LTV, цвет — канал.  

**В конце раздела:** выводы по визуальному анализу — лучшие каналы, устойчивые сегменты, риски оттока.

---

### 7. 🔍 Исследовательский анализ данных  
**Цель раздела:** выявить скрытые закономерности.  

**Необходимо:**  
- визуализировать распределение чеков (histogram, boxplot);  
- проанализировать сезонность продаж;  
- исследовать частоту покупок и средний чек;  
- сравнить поведение новых и возвращающихся клиентов.

---

### 8. 📣 Маркетинг и анализ окупаемости  

#### 8.1 💼 Анализ общей окупаемости бизнеса  
- суммарная выручка vs. общие маркетинговые затраты;  
- общий ROI;  
- интерпретация рентабельности.  

#### 8.2 📊 Анализ окупаемости по каналам привлечения  
- ROI по каждому каналу (`Channel`);  
- сравнение эффективности;  
- выявление убыточных и прибыльных источников.  

#### 8.3 👥 Анализ окупаемости пользовательских сегментов  
- сопоставление сегментов (из Датасета 2) с гипотетическим LTV;  
- рекомендации по таргетингу на основе демографии и поведения.  

#### 8.4 🛒 Анализ окупаемости продуктовых категорий  
- сравнение категорий по выручке и частоте покупок;  
- выявление «лидеров» и «аутсайдеров»;  
- предложения по перераспределению маркетингового бюджета.  

**В конце раздела:** промежуточные выводы по стратегии роста и оптимизации.

---

### 9. 🧾 Выводы  
В финальном разделе необходимо:  
- сформулировать **ключевые бизнес-инсайты**;  
- определить **наиболее ценные сегменты пользователей и категорий**;  
- оценить **эффективность маркетинговых каналов** (с учётом допущений);  
- предложить **рекомендации** по росту удержания, LTV и ROI;  
- указать **ограничения исследования** (независимость датасетов, отсутствие прямой атрибуции);  
- обозначить **направления для дальнейшего анализа** (прогноз churn, AB-тесты, персонализация рекомендаций).

---

