# 📈 Кейс. Бизнес-аналитика e-commerce сервиса: удержание, конверсия, LTV и окупаемость

## 🎯 Постановка задачи

Компания в сфере электронной коммерции анализирует поведение пользователей и эффективность маркетинговых активностей.
Цель исследования — определить, какие пользовательские сегменты приносят наибольшую ценность бизнесу, какие каналы привлечения являются наиболее эффективными и как окупаются инвестиции в маркетинг.

В рамках кейса необходимо провести комплексный бизнес-анализ на основе нескольких взаимосвязанных датасетов, включающий расчет ключевых продуктовых и маркетинговых метрик: **Retention, Conversion, LTV и ROI**.
Результатом выполнения задания должен стать **Jupyter Notebook**, содержащий код, расчёты, функции, визуализации и аналитические выводы.

---

## 📦 Используемые датасеты 
В рамках кейса используются **три датасета**, отражающие разные аспекты работы e-commerce сервиса.
### 📁 Входные данные (обзор)

---

### 📄 Датасет 1 — Online Retail E-Commerce Dataset (UK)

**Kaggle:** [Online Retail Ecommerce Dataset (UK)](https://www.kaggle.com/datasets/ineubytes/online-retail-ecommerce-dataset?utm_source=chatgpt.com)
Содержит транзакционные данные интернет-магазина:
**Тип данных:** транзакционные данные

**Основные признаки:**

* `InvoiceNo` — номер заказа
* `StockCode` — код товара
* `Description` — наименование товара
* `Quantity` — количество
* `InvoiceDate` — дата
* `UnitPrice` — цена за единицу
* `CustomerID` — уникальный покупатель
* `Country` — страна

**Назначение:** расчёт выручки, LTV, создание пользовательских профилей и базовый анализ транзакций.
Используется как основной источник данных о покупках и выручке.
---

### 📄 Датасет 2 — Online Retail II Data Set

**Kaggle:** [Online Retail II Data Set](https://www.kaggle.com/datasets/jillwang87/online-retail-ii?utm_source=chatgpt.com)
Расширенный транзакционный датасет за более длительный период времени.
**Тип данных:** расширенные транзакции

**Особенности:**

* Аналогичный набор признаков, как в первом датасете, но с более длинной историей транзакций.
* Позволяет проводить глубокий когортный и поведенческий анализ пользователей.

**Назначение:** анализ удержания (retention), поведенческих паттернов и сегментации.
---

### 📄 Датасет 3 — E-commerce Business Transaction

**Kaggle:** [E-commerce Business Transaction](https://www.kaggle.com/datasets/gabrielramos87/an-online-shop-business?utm_source=chatgpt.com)
Содержит информацию о маркетинговых расходах:
**Тип данных:** транзакционные данные с продажами и метриками чека

**Основные признаки:**

* общая сумма заказа
* товарная категория
* метрики чека (например, средний чек, количество товаров)

**Назначение:** анализ выручки, сегментация пользователей и продуктов, расчет маркетингового ROI и окупаемости.

---
## Обязательные разделы итогового Jupyter Notebook 

1. Предварительный анализ данных 
2. Предобработка данных 
3. Разработка функций для анализа данных 
4. Разработка функции для создания пользовательских профилей 
5. Разработка функций расчета продуктовых и бизнес-метрик 
6. Визуализация продуктовых и бизнес-метрик 
7. Исследовательский анализ данных 
8. Маркетинг и анализ окупаемости 9. Выводы ---

## 🧩 Структура итогового Jupyter Notebook

### 1. 📊 Предварительный анализ данных
В данном разделе слушателю необходимо провести первичное изучение всех используемых датасетов.
**Цель раздела:** понять структуру, качество и ограничения данных.
**Необходимо:**

* вывести размеры таблиц (`shape`);
* изучить типы данных (`info`);
* оценить пропуски и аномалии;
* кратко описать наблюдения.

**В конце раздела:** краткие выводы по данным и их качеству.

---

### 2. 🧹 Предобработка данных

**Цель раздела:** подготовить данные к расчету метрик и объединению.
**Необходимо:**

* привести даты к формату `datetime`;
* обработать пропущенные значения;
* удалить некорректные транзакции (Quantity ≤ 0, UnitPrice ≤ 0);
* агрегировать данные по пользователям и периодам;
* объединить все датасеты.

**В конце раздела:** промежуточные выводы о подготовке данных.

---

### 3. 🧠 Разработка функций для анализа данных
В данном разделе слушателю необходимо разработать набор универсальных функций, используемых в дальнейших этапах анализа.

**Цель раздела:** создать переиспользуемый аналитический инструментарий.
**Ключевое правило:** **все функции — расчёта метрик и визуализации — создаются здесь**, но **графики строятся и анализируются в отдельном разделе**.

**В этом разделе разрабатываются функции:**

1. Для агрегации данных:

   * по пользователям;
   * по временным периодам (день / неделя / месяц);
2. Для фильтрации данных:

   * по датам;
   * по странам;
   * по сегментам;
3. Для расчёта базовых метрик:

   * DAU / MAU;
   * количество заказов;
   * суммарная и средняя выручка;
4. Для формирования пользовательских профилей:

   * дата первой покупки;
   * дата последней покупки;
   * количество заказов;
   * суммарная выручка;
   * lifetime;
   * при желании — RFM-сегментация;
5. Для расчёта продуктовых и бизнес-метрик:

   * Retention;
   * Conversion;
   * LTV;
   * ROI;
6. Для визуализации:

   * графики retention, конверсии, LTV, ROI (heatmap, line chart, bar chart, scatter plot и др.).

**Структура раздела:**

* краткое теоретическое описание, что такое функции в бизнес-аналитике и зачем их выделять;
* реализация функций;
* промежуточные выводы:

  * какие функции реализованы;
  * какие метрики они рассчитывают;
  * какие функции будут использоваться в следующих разделах.

**Важно:** здесь **не проводится аналитический разбор графиков** и **не делаются бизнес-выводы**.

---

### 4. 👤 Создание пользовательских профилей

**Цель раздела:** сегментировать пользователей.
**Необходимо:**

* использовать разработанные функции для построения профилей;
* рассчитать для каждого пользователя:

  * дату первой покупки;
  * дату последней покупки;
  * количество заказов;
  * суммарную выручку;
  * lifetime;
* при желании реализовать RFM-сегментацию.

**В конце раздела:** выводы по созданным сегментам.

---

### 5. 📐 Расчёт продуктовых и бизнес-метрик

#### 5.1 🔁 Расчет удержания (Retention)

* формирование когорт пользователей;
* расчет retention rate;
* создание retention-матрицы (cohort × period).

#### 5.2 🔄 Расчет конверсии

* расчет конверсии в покупку:

  * по всему продукту;
  * по сегментам;
  * по регионам.

#### 5.3 💰 Расчет LTV и ROI

* расчет LTV по пользователям и когортам;
* объединение доходов и маркетинговых расходов;
* расчет ROI по каналам и периодам.

**В этом разделе:** **используются функции**, но визуализация выполняется в следующем разделе.

---

### 6. 📉 Визуализация продуктовых и бизнес-метрик
В данном разделе слушателю необходимо визуально представить результаты расчетов.

**Цель раздела:** построение графиков с использованием функций из раздела 3 и анализ результатов.

**В начале раздела:** краткое описание роли визуализаций в бизнес-анализе.

**Визуализации:**

1. 🔁 Retention

   * Heatmap: X — период жизни когорты, Y — когорта, цвет — retention rate;
   * Line chart: X — период, Y — retention, линии — разные когорты.
2. 🔄 Conversion

   * Funnel chart: визит → регистрация → покупка;
   * Bar chart: X — сегменты / страны, Y — conversion rate;
   * Stacked bar chart: сравнение конверсии по сегментам и периодам.
3. 💰 LTV и ROI

   * Line chart: X — время жизни когорты, Y — накопленный LTV;
   * Bar chart: X — маркетинговые каналы, Y — ROI;
   * Scatter plot: X — CAC, Y — LTV, цвет — канал привлечения.

**В конце раздела:** выводы по визуальному анализу:

* выявленные тенденции;
* лучшие и худшие каналы, сегменты и периоды;
* информативность визуализаций.

---

### 7. 🔍 Исследовательский анализ данных
В данном разделе слушателю необходимо провести углубленный анализ поведения пользователей.

**Цель раздела:** выявление поведенческих и бизнес-закономерностей.
**Необходимо:**

* визуализировать распределение чеков (histogram, boxplot);
* анализировать поведение пользователей и транзакции.

---

### 8. 📣 Маркетинг и анализ окупаемости
В данном разделе слушателю необходимо выполнить аналитические действия по оценке эффективности маркетинга.

#### 8.1 💼 Анализ общей окупаемости бизнеса

* рассчитать суммарную выручку и маркетинговые затраты; 
* вычислить общий ROI; 
* интерпретировать полученный результат.

#### 8.2 📊 Анализ окупаемости по каналам привлечения

* рассчитать ROI по каждому каналу; 
*  сравнить эффективность каналов; 
*  выявить убыточные и прибыльные источники трафика.

#### 8.3 👥 Анализ окупаемости пользовательских сегментов

* рассчитать LTV и ROI по сегментам; 
* выявить нерентабельные сегменты; 
* сформулировать рекомендации по оптимизации маркетинга.

#### 8.4 🛒 Анализ окупаемости продуктовых категорий

* сравнить категории по выручке и LTV; 
* определить категории с наибольшим потенциалом роста; 
* предложить рекомендации по перераспределению бюджета.

**В конце раздела:** промежуточные выводы по маркетинговой окупаемости.

---

### 9. 🧾 Выводы

В финальном разделе слушателю необходимо:

* сформулировать ключевые бизнес-инсайты;
* определить наиболее ценные сегменты пользователей; 
* оценить эффективность маркетинговых активностей; 
* предложить рекомендации по росту удержания и LTV;
*  указать ограничения исследования и направления дальнейшего развития анализа.

---
