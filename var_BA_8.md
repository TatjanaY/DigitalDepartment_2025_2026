# 📈 Кейс. Бизнес-аналитика розничной торговли: продажи, клиенты, сегментация, LTV и ROI

## 🎯 Постановка задачи

Компания управляет **сетью розничных магазинов и/или e-commerce платформой** и стремится глубже понять поведение покупателей, структуру продаж и эффективность маркетинга.  

**Цель исследования** — определить:  
- какие товары и категории приносят наибольшую выручку;  
- какие сегменты клиентов наиболее прибыльны и лояльны;  
- как изменяется поведение покупателей во времени (частота, чек, удержание);  
- какие маркетинговые каналы оправдывают вложения.  

В рамках кейса необходимо провести **комплексный бизнес-анализ** на основе **трёх взаимосвязанных датасетов**, включающий расчёт ключевых продуктовых и маркетинговых метрик: **Retention, Conversion, LTV и ROI**.

**Результатом выполнения задания** должен стать **Jupyter Notebook**, содержащий код, расчёты, функции, визуализации и аналитические выводы.

---

## 📦 Используемые датасеты

В рамках кейса используются **три датасета**, отражающие транзакции, онлайн-продажи и клиентские профили.

### 📁 Входные данные (обзор)

---

### 📄 Датасет 1 — Retail Transactions Dataset  
**Kaggle:** [https://www.kaggle.com/datasets/prasad22/retail-transactions-dataset](https://www.kaggle.com/datasets/prasad22/retail-transactions-dataset)  

**Тип данных:** транзакционные данные розничной торговли  

**Основные признаки:**  
- `Transaction_ID` — идентификатор операции  
- `Customer_ID` — покупатель  
- `Product_ID` — товар  
- `Quantity` — количество  
- `Price` — цена за единицу  
- `Transaction_Date` — дата покупки  

**Назначение:**  
Используется как **основной источник данных о офлайн- и онлайн-продажах**, для расчёта **выручки**, **частоты покупок**, **среднего чека** и **пользовательских профилей**.

---

### 📄 Датасет 2 — E-Commerce Sales Dataset  
**Kaggle:** [https://www.kaggle.com/datasets/thedevastator/unlock-profits-with-e-commerce-sales-data](https://www.kaggle.com/datasets/thedevastator/unlock-profits-with-e-commerce-sales-data)  

**Тип данных:** данные о продажах в интернет-магазине  

**Основные признаки:**  
- `Order ID` — номер заказа  
- `Product Name` — наименование товара  
- `Category` — категория  
- `Order Date` — дата заказа  
- `Sales` — выручка по позиции  
- `CustomerID` — покупатель  

**Назначение:**  
Позволяет анализировать **онлайн-поведение**, **популярность категорий**, **сезонность** и сравнивать с офлайн-данными из Датасета 1.

---

### 📄 Датасет 3 — Sales and Customer Insights Dataset  
**Kaggle:** [https://www.kaggle.com/datasets/imranalishahh/sales-and-customer-insights](https://www.kaggle.com/datasets/imranalishahh/sales-and-customer-insights)  

**Тип данных:** продажи + клиентские профили  

**Основные признаки:**  
- `CustomerID` — уникальный покупатель  
- `Age`, `Gender`, `Location` — демография  
- `Total Spend` — суммарные траты  
- `Purchase Frequency` — частота покупок  
- `Last Purchase Date` — дата последней покупки  

**Назначение:**  
Используется для **сегментации клиентов**, **расчёта LTV**, **анализа удержания** и **персонализации маркетинга**.

---

## 📝 Обязательные разделы итогового Jupyter Notebook

1. Предварительный анализ данных  
2. Предобработка данных  
3. Разработка функций для анализа данных  
4. Разработка функции для создания пользовательских профилей  
5. Разработка функций расчёта продуктовых и бизнес-метрик  
6. Визуализация продуктовых и бизнес-метрик  
7. Исследовательский анализ данных  
8. Маркетинг и анализ окупаемости  
9. Выводы  

---

## 🧩 Структура итогового Jupyter Notebook

### 1. 📊 Предварительный анализ данных  
**Цель раздела:** понять структуру, качество и ограничения данных.  

**Необходимо:**  
- вывести размеры таблиц (`shape`);  
- изучить типы данных (`info`);  
- оценить пропуски (особенно в `CustomerID`, `Price`);  
- выявить аномалии (например, отрицательные `Quantity` или `Price`);  
- кратко описать особенности каждого датасета.  

**В конце раздела:** краткие выводы по данным и их пригодности к анализу.

---

### 2. 🧹 Предобработка данных  
**Цель раздела:** подготовить данные к расчёту метрик и объединению.  

**Необходимо:**  
- привести все даты (`Transaction_Date`, `Order Date`, `Last Purchase Date`) к формату `datetime`;  
- удалить некорректные записи (`Quantity ≤ 0`, `Price ≤ 0`);  
- рассчитать выручку как `Quantity × Price` (где применимо);  
- обработать пропущенные значения в демографических данных;  
- агрегировать данные по пользователям и временным периодам;  
- объединить датасеты по `CustomerID`.  

**В конце раздела:** промежуточные выводы о структуре и чистоте итогового датасета.

---

### 3. 🧠 Разработка функций для анализа данных  
**Цель раздела:** создать переиспользуемый аналитический инструментарий.  

**Ключевое правило:**  
> Все функции — расчёта метрик и визуализации — создаются здесь,  
> но **графики строятся и анализируются в отдельном разделе**.

**В этом разделе разрабатываются функции:**

1. **Для агрегации данных:**  
   - по пользователям;  
   - по товарам / категориям;  
   - по временным периодам (день / неделя / месяц).  

2. **Для фильтрации данных:**  
   - по датам;  
   - по категориям (`Category`);  
   - по демографии (`Age`, `Gender`, `Location`).  

3. **Для расчёта базовых метрик:**  
   - DAU / MAU;  
   - количество заказов;  
   - суммарная и средняя выручка.  

4. **Для формирования пользовательских профилей:**  
   - дата первой/последней покупки;  
   - количество заказов;  
   - суммарная выручка;  
   - lifetime (в днях);  
   - (опционально) RFM-сегментация.  

5. **Для расчёта продуктовых и бизнес-метрик:**  
   - Retention;  
   - Conversion;  
   - LTV;  
   - ROI (при наличии или условных маркетинговых данных).  

6. **Для визуализации:**  
   - line chart;  
   - bar chart;  
   - heatmap;  
   - scatter plot;  
   - funnel chart.  

**Структура раздела:**  
- краткое введение в модульность;  
- реализация функций с аннотациями;  
- перечень функций и их назначение.

---

### 4. 👤 Создание пользовательских профилей  
**Цель раздела:** сегментировать покупателей.  

**Необходимо:**  
- использовать разработанные функции;  
- рассчитать для каждого клиента:  
  - дату первой покупки;  
  - дату последней покупки;  
  - количество заказов;  
  - суммарную выручку;  
  - lifetime;  
- при желании реализовать **RFM-сегментацию** и выделить:  
  - «ядро» (высокая частота + высокая выручка);  
  - «рискованных» (давно не покупали);  
  - «новичков» с потенциалом.  

**В конце раздела:** выводы по выявленным сегментам.

---

### 5. 📐 Расчёт продуктовых и бизнес-метрик  

#### 5.1 🔁 Расчёт удержания (Retention)  
- формирование когорт по дате первой покупки;  
- расчёт retention rate по неделям/месяцам;  
- создание retention-матрицы (когорта × период жизни).  

#### 5.2 🔄 Расчёт конверсии  
- расчёт конверсии:  
  - в повторную покупку;  
  - по категориям (`Category`);  
  - по демографическим сегментам.  

#### 5.3 💰 Расчёт LTV и ROI  
- расчёт LTV по пользователям и когортам;  
- при наличии маркетинговых данных — расчёт CAC и ROI;  
- при их отсутствии — интерпретация LTV как основной метрики ценности.  

> **Важно:** в этом разделе используются функции, но **визуализация переносится в раздел 6**.

---

### 6. 📉 Визуализация продуктовых и бизнес-метрик  
**Цель раздела:** визуально представить и интерпретировать результаты.  

**Визуализации:**  

1. **🔁 Retention**  
   - Heatmap: X — период жизни, Y — когорта, цвет — retention %;  
   - Line chart: X — время, Y — retention %, линии — когорты.  

2. **🔄 Conversion**  
   - Bar chart: X — категории, Y — повторная покупка %;  
   - Stacked bar chart: X — возрастные группы, Y — конверсия.  

3. **💰 LTV и ROI**  
   - Line chart: X — lifetime, Y — накопленный LTV по когортам;  
   - Bar chart: X — сегменты, Y — LTV;  
   - Scatter plot: X — частота, Y — LTV, цвет — категория.  

**В конце раздела:** выводы по визуальному анализу — лучшие сегменты, тенденции оттока, потенциал роста.

---

### 7. 🔍 Исследовательский анализ данных  
**Цель раздела:** выявить скрытые закономерности.  

**Необходимо:**  
- визуализировать распределение чеков (histogram, boxplot);  
- проанализировать топ-категорий по выручке и частоте;  
- исследовать сезонность продаж;  
- сравнить поведение новых и возвращающихся клиентов.

---

### 8. 📣 Маркетинг и анализ окупаемости  

#### 8.1 💼 Анализ общей окупаемости бизнеса  
- суммарная выручка vs. (условные) маркетинговые затраты;  
- общий ROI;  
- интерпретация рентабельности.  

#### 8.2 📊 ROI по каналам/сегментам  
- если маркетинговые данные доступны — расчёт ROI по каналам;  
- иначе — фокус на **LTV по сегментам** как proxy эффективности.  

#### 8.3 👥 Рекомендации по оптимизации  
- какие сегменты/категории требуют большего внимания;  
- предложения по персонализированным кампаниям;  
- гипотезы для A/B-тестов.

**В конце раздела:** промежуточные выводы по стратегии роста.

---

### 9. 🧾 Выводы  
В финальном разделе необходимо:  
- сформулировать **ключевые бизнес-инсайты**;  
- определить **наиболее ценные сегменты клиентов и категорий**;  
- оценить **потенциал удержания и роста LTV**;  
- предложить **конкретные рекомендации** по ассортименту, маркетингу и продукту;  
- указать **ограничения исследования** (например, отсутствие данных о возвратах или маркетинге);  
- обозначить **направления для дальнейшего анализа** (прогноз churn, рекомендательные системы, персонализация).

---

